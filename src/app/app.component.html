<div *ngIf="busy" class="container m-3">
  {{busyMessage}}<br>
  <img src="assets/ajax-loader.gif" />
</div>
<div *ngIf="!busy && filteredImageDataArray && filteredImageDataArray.length > 0" class="container">
  <div class="btn-toolbar mb-3" role="toolbar" aria-label="Navigational controls">
    <div class="btn-group mr-3" role="group" aria-label="Historical Back">
        <button type="button" class="btn btn-secondary" (click)="back()">Last Viewed</button>
    </div>
    <div class="btn-group mr-3" role="group" aria-label="Primary Navigation">
      <button type="button" class="btn btn-danger m-1" (click)="prev()"><i class="fa fa-arrow-circle-left"></i> Prev</button>
      <button type="button" class="btn btn-success m-1" (click)="doRandom()"><i class="fa fa-random"></i> Random</button>
      <button type="button" class="btn btn-danger m-1" (click)="next()"><i class="fa fa-arrow-circle-right"></i> Next</button>
    </div>
    <div class="btn-group mr-3" role="group" aria-label="Other commands">
      <button type="button" class="btn btn-primary m-1" (click)="copyImageToClipboard()"><i class="fa fa-clipboard"></i> Copy Image</button>
      <button type="button" class="btn btn-primary m-1" (click)="openImageInApp()"><i class="fa fa-open"></i> Open Image</button>
      <button [hidden]="showForm" (click)="viewForm()" type="button" class="btn btn-secondary m-1"><i class="fa fa-plus-square"></i> Show Filters</button>
      <button [hidden]="!showForm" (click)="showForm = false" type="button" class="btn btn-secondary m-1"><i class="fa fa-minus-square-o"></i> Hide Filters</button>
      <button [hidden]="filteredImageDataArray?.length === imageDataArray?.length" (click)="clearFilters()" type="button" class="btn btn-info m-1">
        <span class="fa-stack fa-2x">
          <i class="fa fa-filter fa-stack-1x"></i>
          <i class="fa fa-ban fa-stack-2x" style="color:Tomato"></i>
        </span> 
        Clear Filters
      </button>
    </div>
  </div>
  <form [hidden]="!showForm" class="mr-3 mb-2">
    <div class="form-group">
      <label class="radio-inline"> 
        <input type="radio" name="filter_mode" value="any" [(ngModel)]="filterMode"> ANY
      </label>
      <label class="radio-inline"> 
        <input class="ml-2" type="radio" name="filter_mode" value="all" [(ngModel)]="filterMode"> ALL
      </label>
      <input #filterTagInputInForm (keyup)="filterTagsForFilter($event.target.value)" class="m-2" type="text" id="filtertagsforfilter" name="filtertagsforfilter">
    </div>
    <div class="form-group">
      <label [hidden]="!shownTagsForFilterTags[tag.tagName]" *ngFor="let tag of tags" class="checkbox-inline">
        <input class="ml-2" type="checkbox" name="{{tag.tagName}}" (change)="selectTagForFilter($event.target.checked, tag.tagName)" [checked]="filterImageFlags[tag.tagName]" /> {{tag.tagName}}
      </label>
    </div>
    <button type="button" (click)="filterImages()" class="btn btn-primary"><i class="fa fa-filter"></i> Apply Filter</button>
  </form>
  <div class="row">
    <div class="col">
      <img style="max-width: 100%; min-height: 600px; max-height: 600px;" src="file:///{{filteredImageDataArray[currentIndex].fullPath}}">
    </div>
  </div>
  <div class="row">
    <div class="col">
      (index={{(currentIndex + 1)}} of {{filteredImageDataArray.length}}) File Path: {{filteredImageDataArray[currentIndex].fullPath}}
    </div>
  </div>
  <div class="row mb-2">
    <label class="mr-2" for="newtag">New Tag:</label>
    <input #tagInput (keyup)="filterItems($event)" class="mr-2" type="text" id="newtag" name="newtag" [(ngModel)]="newTag">
    <button [disabled]="newTag === null || newTag.trim() === '' || tagNames.includes(newTag.trim().toUpperCase())" type="button" (click)="addTag()" class="btn btn-primary mr-1">Add Tag</button>
  </div>
  <div class="row mb-2">
    <label [hidden]="!shownTags[tag.tagName]" *ngFor="let tag of tags" class="checkbox-inline">
      <input class="ml-2" type="checkbox" name="{{tag.tagName}}" [checked]="tagFlags[tag.tagName]" (change)="updateTagFromUI($event.target.checked, tag.tagName)" /> {{tag.tagName}}
    </label>
  </div>
</div>
<router-outlet></router-outlet>
